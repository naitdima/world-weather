(function(e){function t(t){for(var n,o,i=t[0],u=t[1],s=t[2],p=0,d=[];p<i.length;p++)o=i[p],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);l&&l(t);while(d.length)d.shift()();return c.push.apply(c,s||[]),r()}function r(){for(var e,t=0;t<c.length;t++){for(var r=c[t],n=!0,i=1;i<r.length;i++){var u=r[i];0!==a[u]&&(n=!1)}n&&(c.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},a={app:0},c=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/world-weather/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var l=u;c.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"0a87":function(e,t,r){"use strict";r("88f6")},"2f7b":function(e,t,r){"use strict";r("4231")},4231:function(e,t,r){},4259:function(e,t,r){"use strict";r("ed96")},"456f":function(e,t,r){"use strict";r("ffbd")},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("7a23"),a=r("bfbe"),c=r("d4ec"),o=r("262e"),i=r("2caf"),u=r("9072"),s=function(e){Object(o["a"])(r,e);var t=Object(i["a"])(r);function r(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"An error occurred. Please try again later.";return Object(c["a"])(this,r),n=t.call(this),n.code=e,n.message=a,n}return r}(Object(u["a"])(Error)),l=(r("fa6d"),r("f95d"),function(e){return Object(n["z"])("data-v-74424f18"),e=e(),Object(n["x"])(),e}),p={class:"main-page"},d=l((function(){return Object(n["i"])("h1",{class:"main-page__title"},"World Weather",-1)})),f=l((function(){return Object(n["i"])("p",{class:"main-page__description"},"Watch weather in your current location",-1)})),h={key:1,class:"main-page__error"},b={key:2,class:"main-page__weather-cards"};function m(e,t,r,a,c,o){var i=Object(n["E"])("card-weather"),u=Object(n["E"])("app-button"),s=Object(n["E"])("modal-choose-city"),l=Object(n["E"])("notifications");return Object(n["w"])(),Object(n["h"])(n["a"],null,[Object(n["i"])("div",p,[d,f,c.currentWeather?(Object(n["w"])(),Object(n["f"])(i,{key:0,class:"main-page__weather-card main-page__weather-card_current",weather:c.currentWeather,current:"",onReload:o.getCurrentWeather},null,8,["weather","onReload"])):null===c.currentWeather?(Object(n["w"])(),Object(n["h"])("p",h," Failed to get the current location ")):Object(n["g"])("",!0),c.weathers.length>0?(Object(n["w"])(),Object(n["h"])("div",b,[(Object(n["w"])(!0),Object(n["h"])(n["a"],null,Object(n["C"])(c.weathers,(function(e,t){return Object(n["w"])(),Object(n["f"])(i,{key:e.city.id,class:"main-page__weather-card",weather:e,removable:"",onReload:function(r){return o.reloadWeather(e,t)},onRemove:function(e){return o.removeWeather(t)}},null,8,["weather","onReload","onRemove"])})),128))])):Object(n["g"])("",!0),Object(n["k"])(u,{class:"main-page__add-btn",icon:"plus",onClick:t[0]||(t[0]=function(e){return c.chooseCityModalIsVisible=!0})})]),c.chooseCityModalIsVisible?(Object(n["w"])(),Object(n["f"])(s,{key:0,onAdd:o.addWeatherByCityName,onClose:t[1]||(t[1]=function(e){return c.chooseCityModalIsVisible=!1})},null,8,["onAdd"])):Object(n["g"])("",!0),Object(n["k"])(l,{position:"bottom center"})],64)}var v=r("3835"),O=r("2909"),j=r("1da1");r("e9c4"),r("d81d"),r("b0c0"),r("a434"),r("d3b7"),r("3ca3"),r("ddb0"),r("96cf");function y(e,t,r,a,c,o){var i=Object(n["E"])("svg-icon");return Object(n["w"])(),Object(n["h"])("button",{class:Object(n["t"])(o.className)},[r.icon?(Object(n["w"])(),Object(n["f"])(i,{key:0,class:"app-button__icon",name:"plus"})):Object(n["D"])(e.$slots,"default",{key:1},void 0,!0)],2)}r("caad");var w={key:0},g=["xlink:href"];function _(e,t,r,a,c,o){return Object(n["w"])(),Object(n["h"])("svg",{class:Object(n["t"])(o.className),xmlns:"http://www.w3.org/2000/svg"},[r.title?(Object(n["w"])(),Object(n["h"])("title",w,Object(n["G"])(r.title),1)):Object(n["g"])("",!0),Object(n["i"])("use",{"xlink:href":o.iconPath,"xmlns:xlink":"http://www.w3.org/1999/xlink"},null,8,g)],2)}var k={name:"svg-icon",props:{name:{type:String,required:!0},title:{type:String,default:null}},computed:{iconPath:function(){var e=r("6f32")("./".concat(this.name,".svg"));return Object.prototype.hasOwnProperty.call(e,"default")&&(e=e.default),e.url},className:function(){return"svg-icon svg-icon--"+this.name}}},C=(r("2f7b"),r("6b0d")),x=r.n(C);const W=x()(k,[["render",_]]);var R=W,S={name:"AppButton",components:{SvgIcon:R},props:{type:{type:String,validate:function(e){return["primary"].includes(e)}},icon:String},computed:{className:function(){var e=["app-button"];return this.type&&e.push("app-button_".concat(this.type)),this.icon&&e.push("app-button_icon"),e}}};r("0a87");const I=x()(S,[["render",y],["__scopeId","data-v-4bcfe8f4"]]);var $=I,E={class:"card-weather"},A={class:"card-weather__name"},B={class:"card-weather__location"},P={class:"card-weather__params"},M={class:"card-weather__params-cell"},N={class:"card-weather__params-cell"},T={class:"card-weather__actions"},V=Object(n["j"])(" Reload "),G=Object(n["j"])(" Remove ");function J(e,t,r,a,c,o){var i=Object(n["E"])("app-button");return Object(n["w"])(),Object(n["h"])("div",E,[Object(n["i"])("h3",A,Object(n["G"])(r.weather.city.name),1),Object(n["i"])("p",B,Object(n["G"])(r.current?"Your current location":r.weather.country.name.common),1),Object(n["i"])("div",P,[(Object(n["w"])(!0),Object(n["h"])(n["a"],null,Object(n["C"])(o.params,(function(e,t){return Object(n["w"])(),Object(n["h"])("div",{key:t,class:"card-weather__params-row"},[Object(n["i"])("div",M,Object(n["G"])(t),1),Object(n["i"])("div",N,Object(n["G"])(e),1)])})),128))]),(Object(n["w"])(),Object(n["h"])("p",{class:"card-weather__timer",key:c.timerKey},Object(n["G"])(o.getTimeAgo(r.weather.updatedDate)),1)),Object(n["i"])("div",T,[Object(n["k"])(i,{class:"card-weather__action",type:"primary",onClick:t[0]||(t[0]=function(t){return e.$emit("reload")})},{default:Object(n["J"])((function(){return[V]})),_:1}),r.removable?(Object(n["w"])(),Object(n["f"])(i,{key:0,class:"card-weather__action",type:"primary",onClick:t[1]||(t[1]=function(t){return e.$emit("remove")})},{default:Object(n["J"])((function(){return[G]})),_:1})):Object(n["g"])("",!0)])])}r("7db0"),r("b65f");var D=r("1315");function K(e){var t,r=["year","month","week","day","hour","minute"],n=D["DateTime"].fromISO(e),a=(t=n.diffNow()).shiftTo.apply(t,r),c=r.find((function(e){return 0!==a.get(e)}))||"second",o=new Intl.RelativeTimeFormat("en",{numeric:"auto"});return o.format(Math.trunc(a.as(c)),c)}var U=function(){return(new Date).toISOString()},q=6e4,H={name:"CardWeather",emits:["reload","remove"],components:{AppButton:$},props:{weather:{type:Object,required:!0},current:{type:Boolean,default:!1},removable:{type:Boolean,default:!1}},data:function(){return{timer:null,timerKey:U()}},computed:{params:function(){var e=this.weather.city,t=e.weather,r=e.main;return{Weather:t[0].main,Temperature:"".concat(r.temp," â„ƒ"),Humidity:"".concat(r.humidity," %")}}},mounted:function(){var e=this;this.timer=setInterval((function(){return e.timerKey=U()}),q)},beforeUnmount:function(){clearInterval(this.timer)},methods:{getTimeAgo:K}};r("4259");const z=x()(H,[["render",J],["__scopeId","data-v-5bb8a1eb"]]);var L=z,F={class:"modal-choose-city__actions"},Y=Object(n["j"])(" Clear "),Z=Object(n["j"])(" Cancel "),Q=Object(n["j"])(" Add ");function X(e,t,r,a,c,o){var i=Object(n["E"])("app-input"),u=Object(n["E"])("app-button"),s=Object(n["E"])("app-modal");return Object(n["w"])(),Object(n["f"])(s,{class:"modal-choose-city",title:"Choose a city",description:"To find city start typing and pick one from the suggestions"},{default:Object(n["J"])((function(){return[Object(n["k"])(i,{ref:"input",class:"modal-choose-city__input",modelValue:a.v$.name.$model,"onUpdate:modelValue":t[0]||(t[0]=function(e){return a.v$.name.$model=e}),error:o.inputError,placeholder:"Search city"},null,8,["modelValue","error"]),Object(n["i"])("div",F,[Object(n["k"])(u,{class:"modal-choose-city__action",onClick:o.clear},{default:Object(n["J"])((function(){return[Y]})),_:1},8,["onClick"]),Object(n["k"])(u,{class:"modal-choose-city__action",type:"primary",onClick:o.close},{default:Object(n["J"])((function(){return[Z]})),_:1},8,["onClick"]),Object(n["k"])(u,{class:"modal-choose-city__action",onClick:o.add},{default:Object(n["J"])((function(){return[Q]})),_:1},8,["onClick"])])]})),_:1})}r("a4d3"),r("e01a");var ee=function(e){return Object(n["z"])("data-v-1f1d465b"),e=e(),Object(n["x"])(),e},te={class:"app-modal"},re=ee((function(){return Object(n["i"])("div",{class:"app-modal__overlay"},null,-1)})),ne={class:"app-modal__title"},ae={class:"app-modal__description"};function ce(e,t,r,a,c,o){return Object(n["w"])(),Object(n["f"])(n["b"],{to:"body"},[Object(n["i"])("div",te,[re,Object(n["i"])("div",Object(n["r"])({class:"app-modal__container"},e.$attrs),[Object(n["i"])("h5",ne,Object(n["G"])(r.title),1),Object(n["i"])("p",ae,Object(n["G"])(r.description),1),Object(n["D"])(e.$slots,"default",{},void 0,!0)],16)])])}var oe={name:"AppModal",props:{title:String,description:String}};r("5f36");const ie=x()(oe,[["render",ce],["__scopeId","data-v-1f1d465b"]]);var ue=ie,se=["placeholder","value"],le={key:0,class:"app-input__error"};function pe(e,t,r,a,c,o){return Object(n["w"])(),Object(n["h"])("div",{class:Object(n["t"])(["app-input",{"app-input_error":r.error}])},[Object(n["i"])("input",{ref:"input",class:"app-input__input",placeholder:r.placeholder,value:r.modelValue,onInput:t[0]||(t[0]=function(t){return e.$emit("update:modelValue",t.target.value)})},null,40,se),r.error?(Object(n["w"])(),Object(n["h"])("p",le,Object(n["G"])(r.error),1)):Object(n["g"])("",!0)],2)}var de={name:"AppInput",props:{modelValue:String,placeholder:String,error:String},emits:["update:modelValue"],methods:{focus:function(){var e;null===(e=this.$refs.input)||void 0===e||e.focus()}}};r("6d0b");const fe=x()(de,[["render",pe],["__scopeId","data-v-4c68cf69"]]);var he=fe,be=r("25a0"),me=r("e3e1"),ve={name:"ModalChooseCity",emits:["close","add"],components:{AppModal:ue,AppInput:he,AppButton:$},setup:function(){return{v$:Object(be["a"])()}},data:function(){return{name:""}},validations:function(){return{name:{required:me["a"].withMessage("City name cannot be empty",me["b"]),regex:me["a"].regex(/^[a-zA-Z]+(?:[\s-][a-zA-Z]+)*$/)}}},computed:{inputError:function(){var e=this.v$.name.$errors;if(0===e.length)return null;var t=Object(v["a"])(e,1),r=t[0].$validator;switch(r){case"required":return"City name cannot be empty";case"regex":return"City name is not valid. Use only latin letters, spaces and dashes.";default:return"City name is not valid"}}},mounted:function(){document.addEventListener("keydown",this.onKeyPress),this.focusInput()},beforeUnmount:function(){document.removeEventListener("keydown",this.onKeyPress)},methods:{focusInput:function(){var e;null===(e=this.$refs.input)||void 0===e||e.focus()},onKeyPress:function(e){var t=e.key;switch(t){case"Enter":return this.add();case"Escape":return this.close()}},clear:function(){this.name="",this.v$.$reset(),this.focusInput()},close:function(){this.$emit("close")},add:function(){this.v$.$touch(),this.v$.$invalid||this.$emit("add",this.name)}}};r("456f");const Oe=x()(ve,[["render",X],["__scopeId","data-v-5e1c375c"]]);var je=Oe,ye=r("bee2"),we=(r("99af"),r("dfd0")),ge=function e(){Object(c["a"])(this,e),this._api=new Proxy({},{get:function(e,t){return Object(j["a"])(regeneratorRuntime.mark((function e(){var r=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,we["a"][t].apply(we["a"],r).json();case 3:return e.abrupt("return",e.sent);case 6:if(e.prev=6,e.t0=e["catch"](0),"HTTPError"!==e.t0.name){e.next=12;break}throw new s(e.t0.response.status);case 12:throw e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,6]])})))}})},_e="44ee365d18c696b751bc085952cadfa0",ke={401:"Check that the API-key is correct",404:"Weather for this city not found"},Ce=function(e){Object(o["a"])(r,e);var t=Object(i["a"])(r);function r(){return Object(c["a"])(this,r),t.apply(this,arguments)}return Object(ye["a"])(r,[{key:"getByCity",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._api.get("https://api.openweathermap.org/data/2.5/weather?q=".concat(t,"&appid=").concat(_e,"&units=metric"));case 3:return e.abrupt("return",e.sent);case 6:if(e.prev=6,e.t0=e["catch"](0),r=ke[e.t0.code],!r){e.next=13;break}throw new s(e.t0.code,r);case 13:throw e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,6]])})));function t(t){return e.apply(this,arguments)}return t}()}]),r}(ge),xe=new Ce,We=function(e){Object(o["a"])(r,e);var t=Object(i["a"])(r);function r(){return Object(c["a"])(this,r),t.apply(this,arguments)}return Object(ye["a"])(r,[{key:"getCountryByCode",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._api.get("https://restcountries.com/v3.1/alpha/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getCityByGeoCoords",value:function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._api.get("https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=".concat(t,"&longitude=").concat(r,"&localityLanguage=en"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()}]),r}(ge),Re=new We,Se={name:"App",components:{AppButton:$,CardWeather:L,ModalChooseCity:je},data:function(){return{chooseCityModalIsVisible:!1,currentWeather:void 0,weathers:[]}},mounted:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getCurrentWeather();case 2:return t.next=4,e.getSavedWeathers();case 4:case"end":return t.stop()}}),t)})))()},watch:{weathers:{deep:!0,handler:function(e){localStorage.setItem("WEATHER_CITY_NAMES",JSON.stringify(e.map((function(e){return e.city.name}))))}}},methods:{reloadWeather:function(e,t){var r=this;return Object(j["a"])(regeneratorRuntime.mark((function n(){var a,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.city.name,n.next=3,r.getWeatherByCityName(a);case 3:c=n.sent,r.weathers.splice(t,1,c);case 5:case"end":return n.stop()}}),n)})))()},removeWeather:function(e){this.weathers.splice(e,1)},getSavedWeathers:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=localStorage.getItem("WEATHER_CITY_NAMES"),!r){t.next=6;break}return t.next=4,Promise.all(JSON.parse(r).map(e.getWeatherByCityName));case 4:a=t.sent,(n=e.weathers).push.apply(n,Object(O["a"])(a));case 6:case"end":return t.stop()}}),t)})))()},addWeatherByCityName:function(e){var t=this;return Object(j["a"])(regeneratorRuntime.mark((function r(){var n,a,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.getWeatherByCityName(e);case 2:if(n=r.sent,a=n.city.id,c=t.weathers.some((function(e){return e.city.id===a})),!c){r.next=7;break}return r.abrupt("return",t.$notify({type:"error",text:"Weather for this city is already displayed"}));case 7:t.weathers.push(n),t.chooseCityModalIsVisible=!1;case 9:case"end":return r.stop()}}),r)})))()},getWeatherByCityName:function(e){return Object(j["a"])(regeneratorRuntime.mark((function t(){var r,n,a,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,xe.getByCity(e);case 2:return r=t.sent,t.next=5,Re.getCountryByCode(r.sys.country);case 5:return n=t.sent,a=Object(v["a"])(n,1),c=a[0],t.abrupt("return",{city:r,country:c,updatedDate:(new Date).toISOString()});case 9:case"end":return t.stop()}}),t)})))()},getCurrentWeather:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var r,n,a,c,o,i,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=function(){return new Promise((function(e,t){navigator.geolocation.getCurrentPosition(e,t)}))},t.prev=1,t.next=4,r();case 4:return n=t.sent,a=n.coords,c=a.latitude,o=a.longitude,t.next=10,Re.getCityByGeoCoords(c,o);case 10:return i=t.sent,u=i.city,t.next=14,e.getWeatherByCityName(u);case 14:e.currentWeather=t.sent,t.next=21;break;case 17:throw t.prev=17,t.t0=t["catch"](1),e.currentWeather=null,t.t0;case 21:case"end":return t.stop()}}),t,null,[[1,17]])})))()}}};r("7c62");const Ie=x()(Se,[["render",m],["__scopeId","data-v-74424f18"]]);var $e=Ie,Ee=Object(n["e"])($e);Ee.use(a["a"]),Ee.config.errorHandler=function(e,t){return t.$notify({type:"error",text:e instanceof s?e.message:"An error occurred"})},Ee.mount("#app")},"5f36":function(e,t,r){"use strict";r("b270")},"6d0b":function(e,t,r){"use strict";r("c606")},"6f32":function(e,t,r){var n={"./plus.svg":"eb38"};function a(e){var t=c(e);return r(t)}function c(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=c,e.exports=a,a.id="6f32"},"7b77":function(e,t,r){},"7c62":function(e,t,r){"use strict";r("7b77")},"88f6":function(e,t,r){},b270:function(e,t,r){},c606:function(e,t,r){},eb38:function(e,t,r){"use strict";r.r(t),t["default"]={id:"plus-usage",viewBox:"0 0 14 14",url:r.p+"img/icons.3720fe4c.svg#plus",toString:function(){return this.url}}},ed96:function(e,t,r){},f95d:function(e,t,r){},ffbd:function(e,t,r){}});
//# sourceMappingURL=app.930720dd.js.map